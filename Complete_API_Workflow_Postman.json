{
	"info": {
		"_postman_id": "18-apis-collection-updated",
		"name": "Hotelsystems.ai - 18 APIs Collection (Updated)",
		"description": "Complete collection with all 18 APIs in correct workflow order\n\n**Total APIs: 18**\n- Health Check: 1 API\n- Admin APIs: 9 APIs (7 existing + 2 Supplier Mapping)\n- Public APIs: 7 APIs\n- Internal APIs: 1 API\n\n**Workflow:**\n1. Setup: Health → Create Hotel → Supplier Mapping → Update Hotel → Create Room Type → Set Inventory → Get Inventory\n2. Search: Get Hotel → Search Offers → Recheck Offer\n3. Booking: Create Booking → Get Booking → Confirm Booking → Cancel Booking\n4. Management: Update Room Type → Update Inventory\n5. Internal: Get Pricing Quote\n\n**✨ New Features (Updated):**\n- ✅ **Idempotency Key**: Add `idempotencyKey` in Create Booking request for duplicate prevention\n- ✅ **Source Field**: Response includes `source` (OWNER/SUPPLIER) automatically set based on supplierCode\n- ✅ **Idempotency Key in Response**: Both CreateBookingResponse and BookingResponse include `idempotencyKey`\n- ✅ **Source Logic**: \n  - If `supplierCode` is null → `source = OWNER` (direct owner inventory)\n  - If `supplierCode` is provided → `source = SUPPLIER`\n\n**Authentication:**\n- All /v1/** endpoints require: `Authorization: Bearer user-123`",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "1. Health Check",
			"item": [
				{
					"name": "Health Check",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/actuator/health",
							"host": ["{{baseUrl}}"],
							"path": ["actuator", "health"]
						},
						"description": "API 1/18: Check if server is running (No authentication required)"
					},
					"response": []
				}
			]
		},
		{
			"name": "2. Admin - Hotel Management",
			"item": [
				{
					"name": "Create Hotel",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"id\": \"hotel-001\",\n    \"name\": \"Grand Hotel Paris\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/v1/admin/hotels",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "admin", "hotels"]
						},
						"description": "API 2/18: Create a new hotel. Slug auto-generated: 'Grand Hotel Paris' → 'grand-hotel-paris'"
					},
					"response": []
				}
			]
		},
		{
			"name": "3. Admin - Supplier Mapping",
			"item": [
				{
					"name": "Get Supplier Mapping",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/v1/admin/hotels/hotel-001/supplier-mapping",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "admin", "hotels", "hotel-001", "supplier-mapping"]
						},
						"description": "API 3/18: Get all supplier mappings for a hotel.\n\n**Returns:** List of supplier mappings with:\n- `hotelId`: Hotel ID\n- `supplierCode`: Supplier code (HOTELBEDS, TRAVELLANDA)\n- `supplierHotelId`: Supplier's hotel ID\n- `status`: Mapping status (ACTIVE, NOT_FOUND, DISABLED)\n- `createdAt`, `updatedAt`: Timestamps"
					},
					"response": []
				},
				{
					"name": "Create/Update Supplier Mapping",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"supplierCode\": \"HOTELBEDS\",\n    \"supplierHotelId\": \"HB-12345\",\n    \"status\": \"ACTIVE\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/v1/admin/hotels/hotel-001/supplier-mapping",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "admin", "hotels", "hotel-001", "supplier-mapping"]
						},
						"description": "API 4/18: Create or update a supplier mapping for a hotel.\n\n**Request Fields:**\n- `supplierCode` (required): HOTELBEDS or TRAVELLANDA\n- `supplierHotelId` (optional): Supplier's hotel ID\n- `status` (required): ACTIVE, NOT_FOUND, or DISABLED\n\n**Note:** Only ONE supplier can be ACTIVE per hotel at a time.\n\n**Response:** Created/updated supplier mapping with all details"
					},
					"response": []
				}
			]
		},
		{
			"name": "4. Admin - Hotel Management (Update)",
			"item": [
				{
					"name": "Update Hotel",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Grand Hotel Paris - Updated\",\n    \"active\": true\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/v1/admin/hotels/hotel-001",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "admin", "hotels", "hotel-001"]
						},
						"description": "API 5/18: Update hotel information (name, active status)"
					},
					"response": []
				}
			]
		},
		{
			"name": "5. Admin - Room Type Management",
			"item": [
				{
					"name": "Create Room Type",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"id\": \"DELUXE\",\n    \"name\": \"Deluxe Room\",\n    \"maxGuests\": 2\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/v1/admin/hotels/hotel-001/room-types",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "admin", "hotels", "hotel-001", "room-types"]
						},
						"description": "API 6/18: Create a room type for the hotel"
					},
					"response": []
				},
				{
					"name": "Update Room Type",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Deluxe Room - Updated\",\n    \"maxGuests\": 3,\n    \"active\": true\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/v1/admin/room-types/DELUXE",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "admin", "room-types", "DELUXE"]
						},
						"description": "API 7/18: Update room type (name, maxGuests, active status)"
					},
					"response": []
				}
			]
		},
		{
			"name": "6. Admin - Inventory Management",
			"item": [
				{
					"name": "Set Inventory (Bulk Upsert)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"roomTypeId\": \"DELUXE\",\n    \"startDate\": \"2025-01-15\",\n    \"endDate\": \"2025-01-25\",\n    \"allotmentQty\": 10,\n    \"stopSell\": false\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/v1/admin/hotels/hotel-001/inventory/bulk-upsert",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "admin", "hotels", "hotel-001", "inventory", "bulk-upsert"]
						},
						"description": "API 8/18: Set inventory for date range. Creates/updates inventory rows for each date.\n\n**Important:** Dates must be today or in the future!"
					},
					"response": []
				},
				{
					"name": "Get Inventory",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/v1/admin/hotels/hotel-001/inventory?roomTypeId=DELUXE&start=2025-01-15&end=2025-01-25",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "admin", "hotels", "hotel-001", "inventory"],
							"query": [
								{
									"key": "roomTypeId",
									"value": "DELUXE"
								},
								{
									"key": "start",
									"value": "2025-01-15"
								},
								{
									"key": "end",
									"value": "2025-01-25"
								}
							]
						},
						"description": "API 9/18: Get inventory for hotel with optional filters (roomTypeId, start, end)\n\n**Save inventoryRowId from response for update operations!**"
					},
					"response": []
				},
				{
					"name": "Update Inventory Row",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"allotmentQty\": 15,\n    \"stopSell\": false\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/v1/admin/inventory/{{inventoryRowId}}",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "admin", "inventory", "{{inventoryRowId}}"]
						},
						"description": "API 10/18: Update individual inventory row. Use inventoryRowId from get inventory response."
					},
					"response": []
				}
			]
		},
		{
			"name": "7. Public - Hotel Information",
			"item": [
				{
					"name": "Get Hotel by Slug",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/v1/hotels/grand-hotel-paris",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "hotels", "grand-hotel-paris"]
						},
						"description": "API 11/18: Get hotel information by slug. Slug is auto-generated from hotel name."
					},
					"response": []
				}
			]
		},
		{
			"name": "8. Public - Offer Search",
			"item": [
				{
					"name": "Search Offers",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"checkIn\": \"2025-01-20\",\n    \"checkOut\": \"2025-01-23\",\n    \"guests\": 2,\n    \"roomsCount\": 1\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/v1/hotels/grand-hotel-paris/offers:search",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "hotels", "grand-hotel-paris", "offers:search"]
						},
						"description": "API 12/18: Search available offers for a hotel. Returns list of available room types with pricing.\n\n**Save the offerId from response!**"
					},
					"response": []
				},
				{
					"name": "Recheck Offer",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"offerId\": \"OWN-abc123def456\",\n    \"checkIn\": \"2025-01-20\",\n    \"checkOut\": \"2025-01-23\",\n    \"guests\": 2,\n    \"roomsCount\": 1\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/v1/offers:recheck",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "offers:recheck"]
						},
						"description": "API 13/18: Recheck offer availability before booking.\n\n**Results:**\n- OK: Offer still available\n- PRICE_CHANGED: Price changed\n- SOLD_OUT: No longer available"
					},
					"response": []
				}
			]
		},
		{
			"name": "9. Public - Booking Management",
			"item": [
				{
					"name": "Create Booking",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"hotelId\": \"hotel-001\",\n    \"roomTypeId\": \"DELUXE\",\n    \"checkIn\": \"2025-01-20\",\n    \"checkOut\": \"2025-01-23\",\n    \"guestName\": \"John Doe\",\n    \"guestEmail\": \"john.doe@example.com\",\n    \"guestPhone\": \"+1234567890\",\n    \"idempotencyKey\": \"booking-{{$randomUUID}}\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/v1/bookings",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "bookings"]
						},
						"description": "API 14/18: Create a booking in DRAFT status.\n\n**Request Fields:**\n- `idempotencyKey` (optional): Unique key for idempotency. If same key is used, returns existing booking.\n  - Example: `\"idempotencyKey\": \"booking-123\"`\n  - If not provided, booking will be created normally\n\n**Response Fields:**\n- `bookingId`: UUID of the booking\n- `status`: Booking status (DRAFT)\n- `idempotencyKey`: Idempotency key (if provided in request)\n- `source`: Booking source (OWNER or SUPPLIER)\n  - **OWNER**: When supplierCode is null (direct owner inventory)\n  - **SUPPLIER**: When supplierCode is provided\n\n**Important:**\n- Save the `bookingId` from response!\n- `source` is automatically set based on whether supplierCode is provided\n- If you use the same `idempotencyKey` again, you'll get the existing booking (idempotent operation)"
					},
					"response": []
				},
				{
					"name": "Get Booking",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/v1/bookings/{{bookingId}}",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "bookings", "{{bookingId}}"]
						},
						"description": "API 15/18: Get booking details by ID. Use bookingId from create booking response.\n\n**Response includes:**\n- `idempotencyKey`: Idempotency key (if provided during creation)\n- `source`: Booking source (OWNER or SUPPLIER)\n- All booking details (status, dates, guest info, price snapshot, etc.)\n\n**Status Values:**\n- DRAFT: Initial state\n- RECHECKING: Being rechecked\n- PENDING_CONFIRMATION: Waiting for confirmation\n- CONFIRMED: Successfully confirmed\n- FAILED: Booking failed\n- CANCELLED: Booking cancelled"
					},
					"response": []
				},
				{
					"name": "Confirm Booking",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{}"
						},
						"url": {
							"raw": "{{baseUrl}}/v1/bookings/{{bookingId}}/confirm",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "bookings", "{{bookingId}}", "confirm"]
						},
						"description": "API 16/18: Confirm a booking.\n\n**Status Flow:**\nDRAFT → RECHECKING → PENDING_CONFIRMATION → CONFIRMED\n\n**Response Codes:**\n- 200 OK: Booking confirmed\n- 409 Conflict: Booking failed (sold out, price changed)\n\n**Response includes:**\n- `idempotencyKey`: Idempotency key (if provided during creation)\n- `source`: Booking source (OWNER or SUPPLIER)\n- `confirmationRef`: Confirmation reference number"
					},
					"response": []
				},
				{
					"name": "Cancel Booking",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/v1/bookings/{{bookingId}}/cancel",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "bookings", "{{bookingId}}", "cancel"]
						},
						"description": "API 17/18: Cancel a confirmed booking. Releases inventory reservation.\n\n**Requirements:**\n- Booking must be in CONFIRMED status\n\n**Response includes:**\n- `idempotencyKey`: Idempotency key (if provided during creation)\n- `source`: Booking source (OWNER or SUPPLIER)\n- Updated status: CANCELLED"
					},
					"response": []
				}
			]
		},
		{
			"name": "10. Internal APIs",
			"item": [
				{
					"name": "Get Pricing Quote",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer user-123",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"hotelId\": \"hotel-001\",\n    \"roomTypeId\": \"DELUXE\",\n    \"checkIn\": \"2025-01-20\",\n    \"checkOut\": \"2025-01-23\",\n    \"guests\": 2,\n    \"currency\": \"USD\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/v1/internal/pricing/quote",
							"host": ["{{baseUrl}}"],
							"path": ["v1", "internal", "pricing", "quote"]
						},
						"description": "API 18/18: Get pricing quote from pricing intelligence service (internal API)"
					},
					"response": []
				}
			]
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8080",
			"type": "string"
		},
		{
			"key": "authToken",
			"value": "user-123",
			"type": "string"
		},
		{
			"key": "bookingId",
			"value": "",
			"type": "string"
		},
		{
			"key": "hotelSlug",
			"value": "grand-hotel-paris",
			"type": "string"
		},
		{
			"key": "offerId",
			"value": "",
			"type": "string"
		},
		{
			"key": "inventoryRowId",
			"value": "",
			"type": "string"
		}
	]
}

