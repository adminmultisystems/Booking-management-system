spring:
  application:
    name: Hotelsystems.ai
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev}
  datasource:
    # H2 in-memory database configuration (default)
    url: ${DATASOURCE_URL:jdbc:h2:mem:hotelsystems;DB_CLOSE_DELAY=-1;MODE=PostgreSQL;DATABASE_TO_LOWER=TRUE}
    driver-class-name: ${DATASOURCE_DRIVER:org.h2.Driver}
    username: ${DATASOURCE_USERNAME:sa}
    password: ${DATASOURCE_PASSWORD:}
  jpa:
    database-platform: ${JPA_DATABASE_PLATFORM:org.hibernate.dialect.H2Dialect}
    hibernate:
      ddl-auto: none  # Flyway handles schema creation
    show-sql: false
    open-in-view: false  # Disable Open Session in View to prevent lazy loading issues
    properties:
      hibernate:
        format_sql: true
        transaction:
          jta:
            platform: none  # Disable JTA platform warning
  h2:
    console:
      enabled: ${H2_CONSOLE_ENABLED:true}
      path: /h2-console
      settings:
        web-allow-others: false
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true

server:
  port: ${SERVER_PORT:8080}

logging:
  level:
    root: INFO
    com.hotelsystems.ai.bookingmanagement: INFO
    org.springframework.web: INFO
    org.hibernate: WARN

management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: when-authorized
    info:
      enabled: true

# Supplier Configuration (Phase 1)
supplier:
  http:
    connect-timeout-ms: 5000
    read-timeout-ms: 10000
  
  hotelbeds:
    base-url: ${HOTELBEDS_BASE_URL:https://api.hotelbeds.com}
    api-key: ${HOTELBEDS_API_KEY:}
    timeout-ms: ${HOTELBEDS_TIMEOUT_MS:30000}
  
  travellanda:
    base-url: ${TRAVELLANDA_BASE_URL:https://api.travellanda.com}
    api-key: ${TRAVELLANDA_API_KEY:}
    timeout-ms: ${TRAVELLANDA_TIMEOUT_MS:30000}

# Additional supplier config (for future use)
suppliers:
  hotelbeds:
    baseUrl: ${HOTELBEDS_BASE_URL:https://api.test.hotelbeds.com/hotel-api/1.0}
    apiKey: ${HOTELBEDS_API_KEY:}
    secret: ${HOTELBEDS_SECRET:}
    timeoutMs: ${HOTELBEDS_TIMEOUT_MS:8000}

---
# Dev profile configuration
spring:
  config:
    activate:
      on-profile: dev
  datasource:
    # H2 in-memory database for development
    url: jdbc:h2:mem:hotelsystems;DB_CLOSE_DELAY=-1;MODE=PostgreSQL;DATABASE_TO_LOWER=TRUE
    driver-class-name: org.h2.Driver
    username: sa
    password: 
  jpa:
    database-platform: org.hibernate.dialect.H2Dialect
    hibernate:
      ddl-auto: none  # Flyway handles schema creation
    show-sql: true  # Enable SQL logging for development
    open-in-view: false  # Disable Open Session in View to prevent lazy loading issues
    properties:
      hibernate:
        format_sql: true
        transaction:
          jta:
            platform: none  # Disable JTA platform warning
  h2:
    console:
      enabled: true
      path: /h2-console
      settings:
        web-allow-others: false
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true

debug:
  key: ${DEBUG_KEY:local-debug}

---
# H2 Database Configuration for Development (Alternative profile)
spring:
  config:
    activate:
      on-profile: h2
  
  application:
    name: Hotelsystems.ai

  # H2 Database Configuration (In-Memory)
  datasource:
    url: jdbc:h2:mem:hotelsystems;MODE=PostgreSQL;DATABASE_TO_LOWER=TRUE;DB_CLOSE_DELAY=-1
    driver-class-name: org.h2.Driver
    username: sa
    password: ""

  # H2 Console (Optional - for viewing data in browser)
  # Access at: http://localhost:8080/h2-console
  # JDBC URL: jdbc:h2:mem:hotelsystems
  h2:
    console:
      enabled: true
      path: /h2-console

  # JPA/Hibernate Configuration for H2
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.H2Dialect
        format_sql: true

---
# PostgreSQL Database Configuration for Production
spring:
  config:
    activate:
      on-profile: postgres
  
  application:
    name: Hotelsystems.ai

  # PostgreSQL Database Configuration
  datasource:
    url: jdbc:postgresql://localhost:5432/hotelsystems
    username: postgres
    password: postgres
    driver-class-name: org.postgresql.Driver

  # JPA/Hibernate Configuration for PostgreSQL
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
